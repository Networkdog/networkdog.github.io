---
title: "클라우드: 대량의 저용량 파일들을 오브젝트 스토리지 서비스에 효율적으로 업로드하는 방법"
date: 2022-07-16 00:00:00
categories: cloud, storage
---

클라우드 상의 오브젝트 스토리지 서비스들은 일반적으로 데이터 전송에 HTTP/HTTPS 프로토콜을 지원합니다. 

HTTP(S) 프로토콜을 파일 전송의 용도로 사용하는 것은 브라우저의 역사만큼 오래되고 흔한 일이 되었습니다.

대용량 파일을 전송할 때에는 큰 문제가 되지 않는다.

저용량 파일을 전송할 때에는 큰 문제가 된다.

* TCP 연결을 위한 라운드 트립이 발생
* HTTPS 프로토콜의 SSL 협상 시간
HTTPS 프로토콜의 경우에는 최조 연결을 위한 TCP 3-way handshaking 과정에서 소요되는 왕복 시간 외에도 SSL/TLS 협상을 위한 왕복 시간이 추가됩니다.  
* 패킷을 인코딩하기 위한 시간과 CPU 사용량
패킷을 암호화하고 인코딩하기 위한 시간과 CPU 사용량 상승이 동반됩니다.


저용량의 파일이라면 통상적으로 64KB 이하의 크기를 가진 파일을 말하지만 경우에 따라 1MB 이하의 파일을 일컫는 경우도 많다. 

비슷한 맥락으로, 대량의 파일은 100만개 이상의 파일을 말하는 것이 보통이며 경우에 따라 수 천억 개의 파일을 다루기도 한다.

대량의 저용량 파일들은 최근 빅 데이터나 데이터 과학에서 어쩔 수 없이 다루게 되는 경우가 많다. 문제는 이 파일들을 네트워크를 통해 전송하거나 저장할 때 상당한 비효율을 감수해야 한다는 사실이다.

이런 문제는 Blob 스토리지나 S3 같은 오브젝트 스토리지 서비스를 이용할 때 큰 문제가 되기도 한다. 오브젝트 스토리지가 제공하는 Ingress, Egress quota에 비해 한참 뒤쳐진 성능이 나오기 때문이다.

